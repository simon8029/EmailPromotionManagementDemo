@{
    ViewBag.Title = "Add new Permission";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}
@model Simon8029.EMPDemo.WebApp.Areas.Admin.Models.PermissionViewModel
@section headSection{
    <style type="text/css">
        #imgIco {
            width: 16px;
            height: 16px;
            margin-top: 4px;
            display: inline-block;
        }
    </style>
    <script type="text/javascript">
        $(function() {
            //1.当父权限下拉框的value值改变时，自动生成 要添加的子权限的 序号
            $("#PermissionParentId").change(loadOrderNumber);
            $("#PermissionParentId").change();

            $("#PermissionIco").change(changeIcon);
            $("#PermissionIco").change();
        })

        //1.自动生成 序号
        function loadOrderNumber() {
            //1.1获取 选中的父权限id
            var parentId = this.value;
            $.post("/admin/Permission/loadordernumber", { pId: parentId }, function(data) {
                $("#PermissionOrder").val(data);
            });
        }

        function changeIcon() {
            //把选中的 图标样式 设置给 演示的 div
            document.getElementById("imgIco").className = this.value;
            //$("#imgIco").class = this.value;
        }

        function begin() {
            //$.msgBoxObj.showWait("请稍后~~~：）");
            
        }

        function complete(xhrObj) {
            //$.msgBoxObj.hide();
            $.messager.alert("Info", "Permission Added.","info",function() {
                $.globalHelper.reloadSeletecTabDataGrid();
                $.globalHelper.closeCommonWindow();
            });
            

            //$.messageProcess(xhrObj.responseText, function () {
            //    $.globalHelper.reloadSeletecTabDataGrid();
            //    $.globalHelper.closeCommonWindow();//消息显示完毕后，关闭公共窗体
        };
    </script>
    }
    @using (Ajax.BeginForm(new AjaxOptions() {OnBegin = "begin", OnComplete = "complete"}))
    {
        <table class="tbList">
            <tr>
                <td>@Html.DisplayNameFor(o => o.PermissionName)</td>
                <td>@Html.TextBoxFor(o => o.PermissionName)</td>
                <td>@Html.ValidationMessageFor(o => o.PermissionName)</td>
            </tr>
            <tr>
                <td>@Html.DisplayNameFor(o => o.PermissionParentId)</td>
                <td>@Html.DropDownListFor(o => o.PermissionParentId, ViewBag.parPers as IEnumerable<SelectListItem>)</td>
                <td>@Html.ValidationMessageFor(o => o.PermissionParentId)</td>
            </tr>
            <tr>
                <td>@Html.DisplayNameFor(o => o.PermissionAreaName)</td>
                <td>@Html.TextBoxFor(o => o.PermissionAreaName)</td>
                <td>@Html.ValidationMessageFor(o => o.PermissionAreaName)</td>
            </tr>
            <tr>
                <td>@Html.DisplayNameFor(o => o.PermissionControllerName)</td>
                <td>@Html.TextBoxFor(o => o.PermissionControllerName)</td>
                <td>@Html.ValidationMessageFor(o => o.PermissionControllerName)</td>
            </tr>
            <tr>
                <td>@Html.DisplayNameFor(o => o.PermissionActionName)</td>
                <td>@Html.TextBoxFor(o => o.PermissionActionName)</td>
                <td>@Html.ValidationMessageFor(o => o.PermissionActionName)</td>
            </tr>
            <tr>
                <td>@Html.DisplayNameFor(o => o.PermissionFormMethod)</td>
                <td>@Html.DropDownListFor(o => o.PermissionFormMethod, Simon8029.EMPDemo.WebApp.Helpers.EnumHelper.FormMethod.DDLData)</td>
                <td>@Html.ValidationMessageFor(o => o.PermissionFormMethod)</td>
            </tr>
            <tr>
                <td>@Html.DisplayNameFor(o => o.PermissionOperationType)</td>
                <td>@Html.DropDownListFor(o => o.PermissionOperationType, Simon8029.EMPDemo.WebApp.Helpers.EnumHelper.OperationType.DDLData)</td>
                <td>@Html.ValidationMessageFor(o => o.PermissionOperationType)</td>
            </tr>
            <tr>
                <td>@Html.DisplayNameFor(o => o.PermissionIco)</td>
                <td>
                    @Html.DropDownListFor(o => o.PermissionIco, Simon8029.EMPDemo.WebApp.Helpers.EnumHelper.IconClassName.DDLData)
                    <div class="icon-cut" id="imgIco"></div>
                </td>
                <td>@Html.ValidationMessageFor(o => o.PermissionIco)</td>
            </tr>
            <tr>
                <td>@Html.DisplayNameFor(o => o.PermissionOrder)</td>
                <td>@Html.TextBoxFor(o => o.PermissionOrder)</td>
                <td>@Html.ValidationMessageFor(o => o.PermissionOrder)</td>
            </tr>
            <tr>
                <td>@Html.DisplayNameFor(o => o.PermissionJsMethodName)</td>
                <td>@Html.TextBoxFor(o => o.PermissionJsMethodName)</td>
                <td>@Html.ValidationMessageFor(o => o.PermissionJsMethodName)</td>
            </tr>
            <tr>
                <td>@Html.DisplayNameFor(o => o.PermissionReMark)</td>
                <td>@Html.TextBoxFor(o => o.PermissionReMark)</td>
                <td>@Html.ValidationMessageFor(o => o.PermissionReMark)</td>
            </tr>
            <tr>
                <td colspan="3">
                    <input type="submit" value="Add"/>
                    @Html.DisplayNameFor(o => o.PermissionIsLink) @Html.CheckBoxFor(o => o.PermissionIsLink)
                    @Html.DisplayNameFor(o => o.PermissionIsShow) @Html.CheckBoxFor(o => o.PermissionIsShow)
                </td>
            </tr>
        </table>
    }